/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/. */(function(){var a=function(){function a(a){var b=[].slice.call(arguments,1),c=function(){return a.apply(null,b.concat([].slice.call(arguments)))};return c}function b(){var a;return window.XMLHttpRequest?a=new window.XMLHttpRequest:window.ActiveXObject&&(a=new window.ActiveXObject("Microsoft.XMLHTTP")),a}function c(){}function d(a,b){try{a.readyState===4&&(a.onreadystatechange=c,b&&b(a.responseText,a.status,a.statusText))}catch(d){}}function e(a){var b=[],c="";for(var d in a)typeof a[d]!="undefined"&&b.push(encodeURIComponent(d)+"="+encodeURIComponent(a[d]));return b&&b.length&&(c=b.join("&")),c}function f(a,b){var c={"X-Requested-With":"XMLHttpRequest",Accept:"application/json;text/plain"};for(var d in a)c[d]=a[d];for(var e in c)b.setRequestHeader(e,c[e])}function g(a,b,c){var d=e(c);return b==="GET"&&d&&(a+="?"+d),a}function h(a,b,c){var d;if(b!=="GET"&&c)switch(a){case"application/json":typeof c=="string"?d=c:d=JSON.stringify(c);break;case"application/x-www-form-urlencoded":d=e(c);break;default:}return d||null}function i(c,e,i){var j=b();if(!j)throw"could not get XHR object";j.onreadystatechange=a(d,j,e);var k=(c.type||"GET").toUpperCase(),l=c.contentType||"application/x-www-form-urlencoded",m=g(c.url,k,c.data);i=h(l,k,c.data),j.open(k,m,!0);var n={"Content-type":l};for(var o in c.headers)n[o]=c.headers[o];return f(n,j),j.send(i),j}"use strict";var j={ajax:function(a){var b=a.error,c=a.success,d={readyState:0},e=i(a,function(a,e,f){d.status=e,d.responseText=a,d.statusText||(d.statusText=e!==0?f:"error"),d.readyState=4;if(e>=200&&e<300||e===304){var g=a;try{g=JSON.parse(a)}catch(h){}c&&c(g,a,d)}else b&&b(d,e,a)});return d.abort=function(){d.statusText="aborted",e.abort()},d}};return j}();(function(a,b){function l(a){if(Object.create)return Object.create(a);var b=function(){};return b.prototype=a,new b}function m(){return(new Date).getTime()}function n(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=Math.random()*16|0,c=a==="x"?b:b&3|8;return c.toString(16)})}"use strict";var c="__speed_trap__",d={init:function(a){a=a||{},this.navigationTiming=l(h),this.navigationTiming.init(a),this.baseTime=this.navigationTiming.get().navigationStart,this.timers=l(i),this.timers.init({baseTime:this.baseTime}),this.events=l(j),this.events.init({baseTime:this.baseTime}),this.stored=l(k),this.uuid=n()},get:function(){return{uuid:this.uuid,navigationTiming:this.navigationTiming.diff(),timers:this.timers.get(),events:this.events.get()}},store:function(){this.stored.store(this.get())}},e={navigationStart:b,unloadEventStart:b,unloadEventEnd:b,redirectStart:b,redirectEnd:b,fetchStart:b,domainLookupStart:b,domainLookupEnd:b,connectStart:b,connectEnd:b,secureConnectionStart:b,requestStart:b,responseStart:b,responseEnd:b,domLoading:b,domInteractive:b,domContentLoadedEventStart:b,domContentLoadedEventEnd:b,domComplete:b,loadEventStart:b,loadEventEnd:b},f;try{f=window.performance.timing}catch(g){f=l(e)}var h={init:function(a){a=a||{},this.navigationTiming=a.navigationTiming||f,this.baseTime=this.navigationTiming.navigationStart},get:function(){return this.navigationTiming},diff:function(){var a={},b=this.baseTime;for(var c in e)this.navigationTiming[c]?a[c]=this.navigationTiming[c]-b:a[c]=null;return a}},i={init:function(a){this.completed={},this.running={},this.baseTime=a.baseTime},start:function(a){var b=m();if(this.running[a])throw new Error(a+" timer already started");this.running[a]=b},stop:function(a){var b=m();if(!this.running[a])throw new Error(a+" timer not started");this.completed[a]||(this.completed[a]=[]);var c=this.running[a];this.completed[a].push({start:c-this.baseTime,stop:b-this.baseTime,elapsed:b-c}),this.running[a]=null,delete this.running[a]},get:function(a){return a?this.completed[a]:this.completed}},j={init:function(a){this.events=[],this.baseTime=a.baseTime},capture:function(a){this.events.push({type:a,timestamp:m()-this.baseTime})},get:function(){return this.events}},k={store:function(a){var b=this.get(),d=b[b.length-1];d&&d.uuid===a.uuid&&b.pop(),b.push(a),localStorage.setItem(c,JSON.stringify(b))},get:function(){var a=localStorage.getItem(c)||"[]",b=JSON.parse(a);return b},clear:function(){localStorage.removeItem(c)}};a.SpeedTrap=l(d),a.SpeedTrap.init()})(this),function(){function d(){setTimeout(function(){var a=b.get();e(a,function(){})},100)}function e(b,c){a.ajax({type:"POST",url:"https://rum-diary.org/navigation",contentType:"application/json",data:b,success:function(a,b,d){c()}})}"use strict";var b=window.SpeedTrap;b.init();try{window.addEventListener("load",d,!1)}catch(c){window.attachEvent("onload",d)}}()})()
